/* This file is part of the Marching Cubes GPU based algorithm based on 
 * Paul Bourke's tabulation approach to marching cubes
 * http://paulbourke.net/geometry/polygonise/
 *
 *
 * We model cubes with 8 vertices labelled as below
 *
 *
 *            3--------(7)---------7
 *           /|                   /|
 *          / |                  / |
 *         /  |                 /  |
 *       (2)  |               (A)  |
 *       /    |               /    |
 *      /    (3)             /    (B)
 *     /      |             /      |
 *    2---------(6)--------6       |
      |       |            |       |
 *    |       0------(4)---|-------4
 *    |      /             |      /
 *   (1)    /             (9)    /
 *    |    /               |    /
 *    |  (0)               |  (8)
 *    |  /                 |  /
 *    | /                  | /
 *    |/                   |/
 *    1---------(5)--------5
 *
 * where X axis is horizontal, +ve to right
 *       Y axis is vertical, +ve upwards
 *       Z axis is into page, +ve towards front
 *
 * 0: ( x, y,   z   )  4: ( x+1, y,   z   )
 * 1: ( x, y,   z+1 )  5: ( x+1, y,   z+1 )
 * 2: ( x, y+1, z+1 )  6: ( x+1, y+1, z   )
 * 3: ( x, y+1, z   )  7: ( x+1, y+1, z+1 )
 *
 * There are 12 edges, 0 - 11 where each edge connectes two vertices as follows:
 *
 *
 * 0: 0, 1       1: 1, 2       2: 2, 3       3:  3, 0
 * 4: 0, 4       5: 1, 5       6: 2, 6       7:  3, 7
 * 8: 4, 5       9: 5, 6       A: 6, 7       B:  7, 4
 */

 __constant__
uint16_t EDGE_VERTICES[12][2] = {
    { 0, 1 }, { 1, 2 }, { 2, 3 }, { 3, 0 },
    { 0, 4 }, { 1, 5 }, { 2, 6 }, { 3, 7 }, 
    { 4, 5 }, { 5, 6 }, { 6, 7 }, { 7, 4 }
 };

/*
 * This file describes the relationship between the vertices under the surface
 * and the edges which are therefore impacted
 * There are 256 distinct entries
 */
__constant__
uint16_t EDGE_TABLE[256]={
    //        cube index | Vertices under surface                 | Edges impacted                  Bitcode
    //       ------------+----------------------------------------+--------------------------------------------
0x000,   //     0   | 00000000      0000 0000 0000
0x019,   //     1   | 00000001      0000 0001 1001
0x023,   //     2   | 00000010      0000 0010 0011
0x03A,   //     3   | 00000011      0000 0011 1010
0x046,   //     4   | 00000100      0000 0100 0110
0x05F,   //     5   | 00000101      0000 0101 1111
0x065,   //     6   | 00000110      0000 0110 0101
0x07C,   //     7   | 00000111      0000 0111 1100
0x08C,   //     8   | 00001000      0000 1000 1100
0x095,   //     9   | 00001001      0000 1001 0101
0x0AF,   //    10   | 00001010      0000 1010 1111
0x0B6,   //    11   | 00001011      0000 1011 0110
0x0CA,   //    12   | 00001100      0000 1100 1010
0x0D3,   //    13   | 00001101      0000 1101 0011
0x0E9,   //    14   | 00001110      0000 1110 1001
0x0F0,   //    15   | 00001111      0000 1111 0000
0x910,   //    16   | 00010000      1001 0001 0000
0x909,   //    17   | 00010001      1001 0000 1001
0x933,   //    18   | 00010010      1001 0011 0011
0x92A,   //    19   | 00010011      1001 0010 1010
0x956,   //    20   | 00010100      1001 0101 0110
0x94F,   //    21   | 00010101      1001 0100 1111
0x975,   //    22   | 00010110      1001 0111 0101
0x96C,   //    23   | 00010111      1001 0110 1100
0x99C,   //    24   | 00011000      1001 1001 1100
0x985,   //    25   | 00011001      1001 1000 0101
0x9BF,   //    26   | 00011010      1001 1011 1111
0x9A6,   //    27   | 00011011      1001 1010 0110
0x9DA,   //    28   | 00011100      1001 1101 1010
0x9C3,   //    29   | 00011101      1001 1100 0011
0x9F9,   //    30   | 00011110      1001 1111 1001
0x9E0,   //    31   | 00011111      1001 1110 0000
0x320,   //    32   | 00100000      0011 0010 0000
0x339,   //    33   | 00100001      0011 0011 1001
0x303,   //    34   | 00100010      0011 0000 0011
0x31A,   //    35   | 00100011      0011 0001 1010
0x366,   //    36   | 00100100      0011 0110 0110
0x37F,   //    37   | 00100101      0011 0111 1111
0x345,   //    38   | 00100110      0011 0100 0101
0x35C,   //    39   | 00100111      0011 0101 1100
0x3AC,   //    40   | 00101000      0011 1010 1100
0x3B5,   //    41   | 00101001      0011 1011 0101
0x38F,   //    42   | 00101010      0011 1000 1111
0x396,   //    43   | 00101011      0011 1001 0110
0x3EA,   //    44   | 00101100      0011 1110 1010
0x3F3,   //    45   | 00101101      0011 1111 0011
0x3C9,   //    46   | 00101110      0011 1100 1001
0x3D0,   //    47   | 00101111      0011 1101 0000
0xA30,   //    48   | 00110000      1010 0011 0000
0xA29,   //    49   | 00110001      1010 0010 1001
0xA13,   //    50   | 00110010      1010 0001 0011
0xA0A,   //    51   | 00110011      1010 0000 1010
0xA76,   //    52   | 00110100      1010 0111 0110
0xA6F,   //    53   | 00110101      1010 0110 1111
0xA55,   //    54   | 00110110      1010 0101 0101
0xA4C,   //    55   | 00110111      1010 0100 1100
0xABC,   //    56   | 00111000      1010 1011 1100
0xAA5,   //    57   | 00111001      1010 1010 0101
0xA9F,   //    58   | 00111010      1010 1001 1111
0xA86,   //    59   | 00111011      1010 1000 0110
0xAFA,   //    60   | 00111100      1010 1111 1010
0xAE3,   //    61   | 00111101      1010 1110 0011
0xAD9,   //    62   | 00111110      1010 1101 1001
0xAC0,   //    63   | 00111111      1010 1100 0000
0x640,   //    64   | 01000000      0110 0100 0000
0x659,   //    65   | 01000001      0110 0101 1001
0x663,   //    66   | 01000010      0110 0110 0011
0x67A,   //    67   | 01000011      0110 0111 1010
0x606,   //    68   | 01000100      0110 0000 0110
0x61F,   //    69   | 01000101      0110 0001 1111
0x625,   //    70   | 01000110      0110 0010 0101
0x63C,   //    71   | 01000111      0110 0011 1100
0x6CC,   //    72   | 01001000      0110 1100 1100
0x6D5,   //    73   | 01001001      0110 1101 0101
0x6EF,   //    74   | 01001010      0110 1110 1111
0x6F6,   //    75   | 01001011      0110 1111 0110
0x68A,   //    76   | 01001100      0110 1000 1010
0x693,   //    77   | 01001101      0110 1001 0011
0x6A9,   //    78   | 01001110      0110 1010 1001
0x6B0,   //    79   | 01001111      0110 1011 0000
0xF50,   //    80   | 01010000      1111 0101 0000
0xF49,   //    81   | 01010001      1111 0100 1001
0xF73,   //    82   | 01010010      1111 0111 0011
0xF6A,   //    83   | 01010011      1111 0110 1010
0xF16,   //    84   | 01010100      1111 0001 0110
0xF0F,   //    85   | 01010101      1111 0000 1111
0xF35,   //    86   | 01010110      1111 0011 0101
0xF2C,   //    87   | 01010111      1111 0010 1100
0xFDC,   //    88   | 01011000      1111 1101 1100
0xFC5,   //    89   | 01011001      1111 1100 0101
0xFFF,   //    90   | 01011010      1111 1111 1111
0xFE6,   //    91   | 01011011      1111 1110 0110
0xF9A,   //    92   | 01011100      1111 1001 1010
0xF83,   //    93   | 01011101      1111 1000 0011
0xFB9,   //    94   | 01011110      1111 1011 1001
0xFA0,   //    95   | 01011111      1111 1010 0000
0x560,   //    96   | 01100000      0101 0110 0000
0x579,   //    97   | 01100001      0101 0111 1001
0x543,   //    98   | 01100010      0101 0100 0011
0x55A,   //    99   | 01100011      0101 0101 1010
0x526,   //   100   | 01100100      0101 0010 0110
0x53F,   //   101   | 01100101      0101 0011 1111
0x505,   //   102   | 01100110      0101 0000 0101
0x51C,   //   103   | 01100111      0101 0001 1100
0x5EC,   //   104   | 01101000      0101 1110 1100
0x5F5,   //   105   | 01101001      0101 1111 0101
0x5CF,   //   106   | 01101010      0101 1100 1111
0x5D6,   //   107   | 01101011      0101 1101 0110
0x5AA,   //   108   | 01101100      0101 1010 1010
0x5B3,   //   109   | 01101101      0101 1011 0011
0x589,   //   110   | 01101110      0101 1000 1001
0x590,   //   111   | 01101111      0101 1001 0000
0xC70,   //   112   | 01110000      1100 0111 0000
0xC69,   //   113   | 01110001      1100 0110 1001
0xC53,   //   114   | 01110010      1100 0101 0011
0xC4A,   //   115   | 01110011      1100 0100 1010
0xC36,   //   116   | 01110100      1100 0011 0110
0xC2F,   //   117   | 01110101      1100 0010 1111
0xC15,   //   118   | 01110110      1100 0001 0101
0xC0C,   //   119   | 01110111      1100 0000 1100
0xCFC,   //   120   | 01111000      1100 1111 1100
0xCE5,   //   121   | 01111001      1100 1110 0101
0xCDF,   //   122   | 01111010      1100 1101 1111
0xCC6,   //   123   | 01111011      1100 1100 0110
0xCBA,   //   124   | 01111100      1100 1011 1010
0xCA3,   //   125   | 01111101      1100 1010 0011
0xC99,   //   126   | 01111110      1100 1001 1001
0xC80,   //   127   | 01111111      1100 1000 0000
0xC80,   //   128   | 10000000      1100 1000 0000
0xC99,   //   129   | 10000001      1100 1001 1001
0xCA3,   //   130   | 10000010      1100 1010 0011
0xCBA,   //   131   | 10000011      1100 1011 1010
0xCC6,   //   132   | 10000100      1100 1100 0110
0xCDF,   //   133   | 10000101      1100 1101 1111
0xCE5,   //   134   | 10000110      1100 1110 0101
0xCFC,   //   135   | 10000111      1100 1111 1100
0xC0C,   //   136   | 10001000      1100 0000 1100
0xC15,   //   137   | 10001001      1100 0001 0101
0xC2F,   //   138   | 10001010      1100 0010 1111
0xC36,   //   139   | 10001011      1100 0011 0110
0xC4A,   //   140   | 10001100      1100 0100 1010
0xC53,   //   141   | 10001101      1100 0101 0011
0xC69,   //   142   | 10001110      1100 0110 1001
0xC70,   //   143   | 10001111      1100 0111 0000
0x590,   //   144   | 10010000      0101 1001 0000
0x589,   //   145   | 10010001      0101 1000 1001
0x5B3,   //   146   | 10010010      0101 1011 0011
0x5AA,   //   147   | 10010011      0101 1010 1010
0x5D6,   //   148   | 10010100      0101 1101 0110
0x5CF,   //   149   | 10010101      0101 1100 1111
0x5F5,   //   150   | 10010110      0101 1111 0101
0x5EC,   //   151   | 10010111      0101 1110 1100
0x51C,   //   152   | 10011000      0101 0001 1100
0x505,   //   153   | 10011001      0101 0000 0101
0x53F,   //   154   | 10011010      0101 0011 1111
0x526,   //   155   | 10011011      0101 0010 0110
0x55A,   //   156   | 10011100      0101 0101 1010
0x543,   //   157   | 10011101      0101 0100 0011
0x579,   //   158   | 10011110      0101 0111 1001
0x560,   //   159   | 10011111      0101 0110 0000
0xFA0,   //   160   | 10100000      1111 1010 0000
0xFB9,   //   161   | 10100001      1111 1011 1001
0xF83,   //   162   | 10100010      1111 1000 0011
0xF9A,   //   163   | 10100011      1111 1001 1010
0xFE6,   //   164   | 10100100      1111 1110 0110
0xFFF,   //   165   | 10100101      1111 1111 1111
0xFC5,   //   166   | 10100110      1111 1100 0101
0xFDC,   //   167   | 10100111      1111 1101 1100
0xF2C,   //   168   | 10101000      1111 0010 1100
0xF35,   //   169   | 10101001      1111 0011 0101
0xF0F,   //   170   | 10101010      1111 0000 1111
0xF16,   //   171   | 10101011      1111 0001 0110
0xF6A,   //   172   | 10101100      1111 0110 1010
0xF73,   //   173   | 10101101      1111 0111 0011
0xF49,   //   174   | 10101110      1111 0100 1001
0xF50,   //   175   | 10101111      1111 0101 0000
0x6B0,   //   176   | 10110000      0110 1011 0000
0x6A9,   //   177   | 10110001      0110 1010 1001
0x693,   //   178   | 10110010      0110 1001 0011
0x68A,   //   179   | 10110011      0110 1000 1010
0x6F6,   //   180   | 10110100      0110 1111 0110
0x6EF,   //   181   | 10110101      0110 1110 1111
0x6D5,   //   182   | 10110110      0110 1101 0101
0x6CC,   //   183   | 10110111      0110 1100 1100
0x63C,   //   184   | 10111000      0110 0011 1100
0x625,   //   185   | 10111001      0110 0010 0101
0x61F,   //   186   | 10111010      0110 0001 1111
0x606,   //   187   | 10111011      0110 0000 0110
0x67A,   //   188   | 10111100      0110 0111 1010
0x663,   //   189   | 10111101      0110 0110 0011
0x659,   //   190   | 10111110      0110 0101 1001
0x640,   //   191   | 10111111      0110 0100 0000
0xAC0,   //   192   | 11000000      1010 1100 0000
0xAD9,   //   193   | 11000001      1010 1101 1001
0xAE3,   //   194   | 11000010      1010 1110 0011
0xAFA,   //   195   | 11000011      1010 1111 1010
0xA86,   //   196   | 11000100      1010 1000 0110
0xA9F,   //   197   | 11000101      1010 1001 1111
0xAA5,   //   198   | 11000110      1010 1010 0101
0xABC,   //   199   | 11000111      1010 1011 1100
0xA4C,   //   200   | 11001000      1010 0100 1100
0xA55,   //   201   | 11001001      1010 0101 0101
0xA6F,   //   202   | 11001010      1010 0110 1111
0xA76,   //   203   | 11001011      1010 0111 0110
0xA0A,   //   204   | 11001100      1010 0000 1010
0xA13,   //   205   | 11001101      1010 0001 0011
0xA29,   //   206   | 11001110      1010 0010 1001
0xA30,   //   207   | 11001111      1010 0011 0000
0x3D0,   //   208   | 11010000      0011 1101 0000
0x3C9,   //   209   | 11010001      0011 1100 1001
0x3F3,   //   210   | 11010010      0011 1111 0011
0x3EA,   //   211   | 11010011      0011 1110 1010
0x396,   //   212   | 11010100      0011 1001 0110
0x38F,   //   213   | 11010101      0011 1000 1111
0x3B5,   //   214   | 11010110      0011 1011 0101
0x3AC,   //   215   | 11010111      0011 1010 1100
0x35C,   //   216   | 11011000      0011 0101 1100
0x345,   //   217   | 11011001      0011 0100 0101
0x37F,   //   218   | 11011010      0011 0111 1111
0x366,   //   219   | 11011011      0011 0110 0110
0x31A,   //   220   | 11011100      0011 0001 1010
0x303,   //   221   | 11011101      0011 0000 0011
0x339,   //   222   | 11011110      0011 0011 1001
0x320,   //   223   | 11011111      0011 0010 0000
0x9E0,   //   224   | 11100000      1001 1110 0000
0x9F9,   //   225   | 11100001      1001 1111 1001
0x9C3,   //   226   | 11100010      1001 1100 0011
0x9DA,   //   227   | 11100011      1001 1101 1010
0x9A6,   //   228   | 11100100      1001 1010 0110
0x9BF,   //   229   | 11100101      1001 1011 1111
0x985,   //   230   | 11100110      1001 1000 0101
0x99C,   //   231   | 11100111      1001 1001 1100
0x96C,   //   232   | 11101000      1001 0110 1100
0x975,   //   233   | 11101001      1001 0111 0101
0x94F,   //   234   | 11101010      1001 0100 1111
0x956,   //   235   | 11101011      1001 0101 0110
0x92A,   //   236   | 11101100      1001 0010 1010
0x933,   //   237   | 11101101      1001 0011 0011
0x909,   //   238   | 11101110      1001 0000 1001
0x910,   //   239   | 11101111      1001 0001 0000
0x0F0,   //   240   | 11110000      0000 1111 0000
0x0E9,   //   241   | 11110001      0000 1110 1001
0x0D3,   //   242   | 11110010      0000 1101 0011
0x0CA,   //   243   | 11110011      0000 1100 1010
0x0B6,   //   244   | 11110100      0000 1011 0110
0x0AF,   //   245   | 11110101      0000 1010 1111
0x095,   //   246   | 11110110      0000 1001 0101
0x08C,   //   247   | 11110111      0000 1000 1100
0x07C,   //   248   | 11111000      0000 0111 1100
0x065,   //   249   | 11111001      0000 0110 0101
0x05F,   //   250   | 11111010      0000 0101 1111
0x046,   //   251   | 11111011      0000 0100 0110
0x03A,   //   252   | 11111100      0000 0011 1010
0x023,   //   253   | 11111101      0000 0010 0011
0x019,   //   254   | 11111110      0000 0001 1001
0x000,   //   255   | 11111111      0000 0000 0000

};